#!/usr/bin/env node
import {b as b$1,a as a$1}from'./chunk-IPGVLKUO.js';import {a,O,n,R,_ as _$1,s,d,Y,P,p as p$1,i,q as q$1,j,t,b,ca,ea,g,h,e,f,r,N,c,ba,ha,fa,ia,K,M,Q,ka,ja,S,k,da,J,o,F,W as W$1,z as z$2,X,m,T,l,L as L$1,U,G,I,H,V}from'./chunk-KBCEIWCP.js';export{ha as fetchTree,ia as getItemTargetPath,aa as getRegistriesConfig,ja as getRegistriesIndex,Z as getRegistry,fa as getRegistryBaseColor,ea as getRegistryBaseColors,da as getRegistryIcons,_ as getRegistryItems,ca as getRegistryStyles,ba as getShadcnRegistryIndex,$ as resolveRegistryItems,ga as resolveTree}from'./chunk-KBCEIWCP.js';import {p,h as h$1,g as g$1}from'./chunk-5X7HZMP5.js';import*as W from'path';import W__default,{join}from'path';import {promises,existsSync}from'fs';import _ from'fs-extra';import R$1 from'postcss';import Vr from'postcss/lib/at-rule';import tt,{z as z$1}from'zod';import {execa}from'execa';import He from'prompts';import fi,{tmpdir}from'os';import {SyntaxKind,Project,ScriptKind}from'ts-morph';import {Command}from'commander';import Ci from'deepmerge';import*as z from'fs/promises';import z__default from'fs/promises';import {diffLines}from'diff';import {StdioServerTransport}from'@modelcontextprotocol/sdk/server/stdio.js';import {randomBytes}from'crypto';import Hi from'fast-glob';async function Dt(t$1){let e={};if(!_.existsSync(t$1.cwd)||!_.existsSync(W__default.resolve(t$1.cwd,"package.json")))return e["1"]=true,{errors:e,projectInfo:null};let r=t("Preflight checks.",{silent:t$1.silent}).start();_.existsSync(W__default.resolve(t$1.cwd,"components.json"))&&!t$1.force&&(r?.fail(),s.break(),s.error(`A ${d.info("components.json")} file already exists at ${d.info(t$1.cwd)}.
To start over, remove the ${d.info("components.json")} file and run ${d.info("init")} again.`),s.break(),process.exit(1)),r?.succeed();let i=t("Verifying framework.",{silent:t$1.silent}).start(),o=await p$1(t$1.cwd);(!o||o?.framework.name==="manual")&&(e["7"]=true,i?.fail(),s.break(),o?.framework.links.installation&&s.error(`We could not detect a supported framework at ${d.info(t$1.cwd)}.
Visit ${d.info(o?.framework.links.installation)} to manually configure your project.
Once configured, you can use the cli to add components.`),s.break(),process.exit(1)),i?.succeed(`Verifying framework. Found ${d.info(o.framework.label)}.`);let n="Validating Tailwind CSS.";o.tailwindVersion==="v4"&&(n=`Validating Tailwind CSS config. Found ${d.info("v4")}.`);let s$1=t(n,{silent:t$1.silent}).start();o.tailwindVersion==="v3"&&(!o?.tailwindConfigFile||!o?.tailwindCssFile)?(e["5"]=true,s$1?.fail()):o.tailwindVersion==="v4"&&!o?.tailwindCssFile?(e["5"]=true,s$1?.fail()):o.tailwindVersion?s$1?.succeed():(e["5"]=true,s$1?.fail());let a=t("Validating import alias.",{silent:t$1.silent}).start();return o?.aliasPrefix?a?.succeed():(e["6"]=true,a?.fail()),Object.keys(e).length>0&&(e["5"]&&(s.break(),s.error(`No Tailwind CSS configuration found at ${d.info(t$1.cwd)}.`),s.error("It is likely you do not have Tailwind CSS installed or have an invalid configuration."),s.error("Install Tailwind CSS then try again."),o?.framework.links.tailwind&&s.error(`Visit ${d.info(o?.framework.links.tailwind)} to get started.`)),e["6"]&&(s.break(),s.error("No import alias found in your tsconfig.json file."),o?.framework.links.installation&&s.error(`Visit ${d.info(o?.framework.links.installation)} to learn how to set an import alias.`)),s.break(),process.exit(1)),{errors:e,projectInfo:o}}function Lt(t,e){if(t.includes("\0"))return  false;let r;try{r=t;let u="";for(;r!==u&&r.includes("%");)u=r,r=decodeURIComponent(r);}catch{return  false}let i=W__default.normalize(r.replace(/\\/g,"/")),o=W__default.normalize(e),n=u=>u.replace(/\[\.\.\..*?\]/g,"").includes("..");if(n(i)||n(r)||n(t))return  false;let s=u=>u.replace(/\[\.\.\..*?\]/g,""),a=s(t),c=s(r);if([/\.\.[\/\\]/,/[\/\\]\.\./,/\.\./,/\.\.%/,/\x00/,/[\x01-\x1f]/].some(u=>u.test(a)||u.test(c))||(t.includes("~")||r.includes("~"))&&(t.includes("../")||r.includes("../")))return  false;if(/^[a-zA-Z]:[\/\\]/.test(r))return process.platform==="win32"?r.toLowerCase().startsWith(e.toLowerCase()):false;if(W__default.isAbsolute(i))return i.startsWith(o+W__default.sep);let d=W__default.resolve(o,i);return d.startsWith(o+W__default.sep)||d===o}async function Ue(t$1,e,r){if(!e.resolvedPaths.tailwindCss||!t$1||Object.keys(t$1).length===0)return;r={silent:false,...r};let i=e.resolvedPaths.tailwindCss,o=W__default.relative(e.resolvedPaths.cwd,i),n=t(`Updating ${d.info(o)}`,{silent:r.silent}).start(),s=await promises.readFile(i,"utf8"),a=await _r(s,t$1);await promises.writeFile(i,a,"utf8"),n.succeed();}async function _r(t,e){let r=[Dr(e)],i=await R$1(r).process(t,{from:void 0}),o=i.css,n=i.root;if(n.nodes&&n.nodes.length>0){let s=n.nodes[n.nodes.length-1];s.type==="atrule"&&!s.nodes&&!o.trimEnd().endsWith(";")&&(o=o.trimEnd()+";");}return o=o.replace(/\/\* ---break--- \*\//g,""),o=o.replace(/(\n\s*\n)+/g,`

`),o=o.trimEnd(),o}function Dr(t){return {postcssPlugin:"update-css",Once(e){for(let[r,i]of Object.entries(t))if(r.startsWith("@")){let o=r.match(/@([a-zA-Z-]+)\s*(.*)/);if(!o)continue;let[,n,s]=o;if(n==="import"){if(!e.nodes?.find(c=>c.type==="atrule"&&c.name==="import"&&c.params===s)){let c=R$1.atRule({name:"import",params:s,raws:{semicolon:true}}),l=e.nodes?.filter(f=>f.type==="atrule"&&f.name==="import");if(l&&l.length>0){let f=l[l.length-1];c.raws.before=`
`,e.insertAfter(f,c);}else !e.nodes||e.nodes.length,c.raws.before="",e.prepend(c);}}else if(n==="plugin"){let a=s;s&&!s.startsWith('"')&&!s.startsWith("'")&&(a=`"${s}"`);let c=f=>f.startsWith('"')&&f.endsWith('"')||f.startsWith("'")&&f.endsWith("'")?f.slice(1,-1):f;if(!e.nodes?.find(f=>f.type!=="atrule"||f.name!=="plugin"?false:c(f.params)===c(s))){let f=R$1.atRule({name:"plugin",params:a,raws:{semicolon:true,before:`
`}}),d=e.nodes?.filter(g=>g.type==="atrule"&&g.name==="import"),u=e.nodes?.filter(g=>g.type==="atrule"&&g.name==="plugin");if(u&&u.length>0){let g=u[u.length-1];e.insertAfter(g,f);}else if(d&&d.length>0){let g=d[d.length-1];e.insertAfter(g,f),e.insertBefore(f,R$1.comment({text:"---break---"})),e.insertAfter(f,R$1.comment({text:"---break---"}));}else e.prepend(f),e.insertBefore(f,R$1.comment({text:"---break---"})),e.insertAfter(f,R$1.comment({text:"---break---"}));}}else if(typeof i=="object"&&Object.keys(i).length===0){if(!e.nodes?.find(c=>c.type==="atrule"&&c.name===n&&c.params===s)){let c=R$1.atRule({name:n,params:s,raws:{semicolon:true}});e.append(c),e.insertBefore(c,R$1.comment({text:"---break---"}));}}else if(n==="keyframes"){let a=e.nodes?.find(f=>f.type==="atrule"&&f.name==="theme"&&f.params==="inline");a||(a=R$1.atRule({name:"theme",params:"inline",raws:{semicolon:true,between:" ",before:`
`}}),e.append(a),e.insertBefore(a,R$1.comment({text:"---break---"})));let c=a.nodes?.find(f=>f.type==="atrule"&&f.name==="keyframes"&&f.params===s),l;if(c?(l=R$1.atRule({name:"keyframes",params:s,raws:{semicolon:true,between:" ",before:`
  `}}),c.replaceWith(l)):(l=R$1.atRule({name:"keyframes",params:s,raws:{semicolon:true,between:" ",before:`
  `}}),a.append(l)),typeof i=="object")for(let[f,d]of Object.entries(i))Z(l,f,d);}else if(n==="utility"){let a=e.nodes?.find(c=>c.type==="atrule"&&c.name===n&&c.params===s);if(a){if(typeof i=="object")for(let[c,l]of Object.entries(i))if(typeof l=="string"){let f=a.nodes?.find(u=>u.type==="decl"&&u.prop===c),d=R$1.decl({prop:c,value:l,raws:{semicolon:true,before:`
    `}});f?f.replaceWith(d):a.append(d);}else typeof l=="object"&&Z(a,c,l);}else {let c=R$1.atRule({name:n,params:s,raws:{semicolon:true,between:" ",before:`
`}});if(e.append(c),e.insertBefore(c,R$1.comment({text:"---break---"})),typeof i=="object")for(let[l,f]of Object.entries(i))if(typeof f=="string"){let d=R$1.decl({prop:l,value:f,raws:{semicolon:true,before:`
    `}});c.append(d);}else typeof f=="object"&&Z(c,l,f);}}else n==="property"?Z(e,r,i):Mt(e,n,s,i);}else Z(e,r,i);}}}function Mt(t,e,r,i){let o=t.nodes?.find(n=>n.type==="atrule"&&n.name===e&&n.params===r);if(o||(o=R$1.atRule({name:e,params:r,raws:{semicolon:true,between:" ",before:`
`}}),t.append(o),t.insertBefore(o,R$1.comment({text:"---break---"}))),typeof i=="object")for(let[n,s]of Object.entries(i))if(n.startsWith("@")){let a=n.match(/@([a-zA-Z-]+)\s*(.*)/);if(a){let[,c,l]=a;Mt(o,c,l,s);}}else Z(o,n,s);else if(typeof i=="string")try{let s=R$1.parse(`.temp{${i}}`).first;if(s&&s.nodes){let a=R$1.rule({selector:"temp",raws:{semicolon:!0,between:" ",before:`
  `}});s.nodes.forEach(c=>{if(c.type==="decl"){let l=c.clone();l.raws.before=`
    `,a.append(l);}}),a.nodes?.length&&o.append(a);}}catch(n){throw console.error("Error parsing at-rule content:",i,n),n}}function Z(t,e,r){let i=t.nodes?.find(o=>o.type==="rule"&&o.selector===e);if(i||(i=R$1.rule({selector:e,raws:{semicolon:true,between:" ",before:`
  `}}),t.append(i)),typeof r=="object"){for(let[o,n]of Object.entries(r))if(o.startsWith("@")&&typeof n=="object"&&n!==null&&Object.keys(n).length===0){let s=o.match(/@([a-zA-Z-]+)\s*(.*)/);if(s){let[,a,c]=s,l=R$1.atRule({name:a,params:c,raws:{semicolon:true,before:`
    `}});i.append(l);}}else if(typeof n=="string"){let s=R$1.decl({prop:o,value:n,raws:{semicolon:true,before:`
    `}}),a=i.nodes?.find(c=>c.type==="decl"&&c.prop===o);a?a.replaceWith(s):i.append(s);}else if(typeof n=="object"){let s=o.startsWith("&")?e.replace(/^([^:]+)/,`$1${o.substring(1)}`):o;Z(t,s,n);}}else if(typeof r=="string")try{let n=R$1.parse(`.temp{${r}}`).first;n&&n.nodes&&n.nodes.forEach(s=>{if(s.type==="decl"){let a=s.clone();a.raws.before=`
    `,i?.append(a);}});}catch(o){throw console.error("Error parsing rule content:",e,r,o),o}}async function Ge(t$1,e,r){if(!e.resolvedPaths.tailwindCss||!Object.keys(t$1??{}).length)return;r={cleanupDefaultNextStyles:false,silent:false,tailwindVersion:"v3",overwriteCssVars:false,initIndex:true,...r};let i=e.resolvedPaths.tailwindCss,o=W__default.relative(e.resolvedPaths.cwd,i),n=t(`Updating CSS variables in ${d.info(o)}`,{silent:r.silent}).start(),s=await promises.readFile(i,"utf8"),a=await Mr(s,t$1??{},e,{cleanupDefaultNextStyles:r.cleanupDefaultNextStyles,tailwindVersion:r.tailwindVersion,tailwindConfig:r.tailwindConfig,overwriteCssVars:r.overwriteCssVars,initIndex:r.initIndex});await promises.writeFile(i,a,"utf8"),n.succeed();}async function Mr(t,e,r,i={cleanupDefaultNextStyles:false,tailwindVersion:"v3",tailwindConfig:void 0,overwriteCssVars:false,initIndex:true}){i={cleanupDefaultNextStyles:false,tailwindVersion:"v3",tailwindConfig:void 0,overwriteCssVars:false,initIndex:true,...i};let o$1=[zr(e)];if(i.cleanupDefaultNextStyles&&o$1.push(Bt()),i.tailwindVersion==="v4"){if(o$1=[],r.resolvedPaths?.cwd){let a=o(r.resolvedPaths.cwd);!a?.dependencies?.["tailwindcss-animate"]&&!a?.devDependencies?.["tailwindcss-animate"]&&i.initIndex&&o$1.push(Yr({params:"tw-animate-css"}));}o$1.push(Jr({params:"dark (&:is(.dark *))"})),i.cleanupDefaultNextStyles&&o$1.push(Bt()),o$1.push(Ur(e,{overwriteCssVars:i.overwriteCssVars})),o$1.push(Gr(e)),i.tailwindConfig&&(o$1.push(qr(i.tailwindConfig)),o$1.push(Hr(i.tailwindConfig)),o$1.push(Kr(i.tailwindConfig)));}r.tailwind.cssVariables&&i.initIndex&&o$1.push(Wr({tailwindVersion:i.tailwindVersion}));let s=(await R$1(o$1).process(t,{from:void 0})).css;return s=s.replace(/\/\* ---break--- \*\//g,""),i.tailwindVersion==="v4"&&(s=s.replace(/(\n\s*\n)+/g,`

`)),s}function Wr({tailwindVersion:t}){return {postcssPlugin:"update-base-layer",Once(e){let r=[{selector:"*",apply:t==="v4"?"border-border outline-ring/50":"border-border"},{selector:"body",apply:"bg-background text-foreground"}],i=e.nodes.find(o=>o.type==="atrule"&&o.name==="layer"&&o.params==="base"&&r.every(({selector:n,apply:s})=>o.nodes?.some(a=>a.type==="rule"&&a.selector===n&&a.nodes.some(c=>c.type==="atrule"&&c.name==="apply"&&c.params===s))));i||(i=R$1.atRule({name:"layer",params:"base",raws:{semicolon:true,between:" ",before:`
`}}),e.append(i),e.insertBefore(i,R$1.comment({text:"---break---"}))),r.forEach(({selector:o,apply:n})=>{i?.nodes?.find(a=>a.type==="rule"&&a.selector===o)||i?.append(R$1.rule({selector:o,nodes:[R$1.atRule({name:"apply",params:n,raws:{semicolon:true,before:`
    `}})],raws:{semicolon:true,between:" ",before:`
  `}}));});}}}function zr(t){return {postcssPlugin:"update-css-vars",Once(e){let r=e.nodes.find(i=>i.type==="atrule"&&i.name==="layer"&&i.params==="base");r instanceof Vr||(r=R$1.atRule({name:"layer",params:"base",nodes:[],raws:{semicolon:true,before:`
`,between:" "}}),e.append(r),e.insertBefore(r,R$1.comment({text:"---break---"}))),r!==void 0&&Object.entries(t).forEach(([i,o])=>{let n=i==="light"?":root":`.${i}`;Br(r,n,o);});}}}function zt(t){let e=t.nodes.find(r=>r.type==="rule"&&r.selector===":root");if(e){let r=["--background","--foreground"];e.nodes.filter(i=>i.type==="decl"&&r.includes(i.prop)).forEach(i=>i.remove()),e.nodes.length===0&&e.remove();}}function Bt(){return {postcssPlugin:"cleanup-default-next-styles",Once(t){let e=t.nodes.find(i=>i.type==="rule"&&i.selector==="body");e&&(e.nodes.find(i=>i.type==="decl"&&i.prop==="color"&&["rgb(var(--foreground-rgb))","var(--foreground)"].includes(i.value))?.remove(),e.nodes.find(i=>i.type==="decl"&&i.prop==="background"&&(i.value.startsWith("linear-gradient")||i.value==="var(--background)"))?.remove(),e.nodes.find(i=>i.type==="decl"&&i.prop==="font-family"&&i.value==="Arial, Helvetica, sans-serif")?.remove(),e.nodes.length===0&&e.remove()),zt(t);let r=t.nodes.find(i=>i.type==="atrule"&&i.params==="(prefers-color-scheme: dark)");r&&(zt(r),r.nodes.length===0&&r.remove());}}}function Br(t,e,r){let i=t.nodes?.find(o=>o.type==="rule"&&o.selector===e);i||Object.keys(r).length>0&&(i=R$1.rule({selector:e,raws:{between:" ",before:`
  `}}),t.append(i)),Object.entries(r).forEach(([o,n])=>{let s=`--${o.replace(/^--/,"")}`,a=R$1.decl({prop:s,value:n,raws:{semicolon:true}}),c=i?.nodes.find(l=>l.type==="decl"&&l.prop===s);c?c.replaceWith(a):i?.append(a);});}function Ur(t,e){return {postcssPlugin:"update-css-vars-v4",Once(r){Object.entries(t).forEach(([i,o])=>{let n=i==="light"?":root":`.${i}`;if(i==="theme"){n="@theme";let a=Ce(r);Object.entries(o).forEach(([c,l])=>{let f=`--${c.replace(/^--/,"")}`,d=R$1.decl({prop:f,value:l,raws:{semicolon:true}}),u=a?.nodes?.find(g=>g.type==="decl"&&g.prop===f);e.overwriteCssVars?u?u.replaceWith(d):a?.append(d):u||a?.append(d);});return}let s=r.nodes?.find(a=>a.type==="rule"&&a.selector===n);!s&&Object.keys(o).length>0&&(s=R$1.rule({selector:n,nodes:[],raws:{semicolon:true,between:" ",before:`
`}}),r.append(s),r.insertBefore(s,R$1.comment({text:"---break---"}))),Object.entries(o).forEach(([a,c])=>{let l=`--${a.replace(/^--/,"")}`;l==="--sidebar-background"&&(l="--sidebar"),Ut(c)&&(c=`hsl(${c})`);let f=R$1.decl({prop:l,value:c,raws:{semicolon:true}}),d=s?.nodes.find(u=>u.type==="decl"&&u.prop===l);e.overwriteCssVars?d?d.replaceWith(f):s?.append(f):d||s?.append(f);});});}}}function Gr(t){return {postcssPlugin:"update-theme",Once(e){let r=Array.from(new Set(Object.keys(t).flatMap(n=>Object.keys(t[n]||{}))));if(!r.length)return;let i=Ce(e),o=i.nodes?.filter(n=>n.type==="decl"&&n.prop.startsWith("--"));for(let n of r){let s=Object.values(t).find(d=>d[n])?.[n];if(!s)continue;if(n==="radius"){let d={sm:"calc(var(--radius) - 4px)",md:"calc(var(--radius) - 2px)",lg:"var(--radius)",xl:"calc(var(--radius) + 4px)"};for(let[u,g]of Object.entries(d)){let h=R$1.decl({prop:`--radius-${u}`,value:g,raws:{semicolon:true}});i?.nodes?.find(y=>y.type==="decl"&&y.prop===h.prop)||i?.append(h);}continue}let a=Ut(s)||Xr(s)?`--color-${n.replace(/^--/,"")}`:`--${n.replace(/^--/,"")}`;a==="--color-sidebar-background"&&(a="--color-sidebar");let c=`var(--${n})`;a==="--color-sidebar"&&(c="var(--sidebar)");let l=R$1.decl({prop:a,value:c,raws:{semicolon:true}});i?.nodes?.find(d=>d.type==="decl"&&d.prop===l.prop)||(o?.length?i?.insertAfter(o[o.length-1],l):i?.append(l));}}}}function Ce(t){let e=t.nodes.find(r=>r.type==="atrule"&&r.name==="theme"&&r.params==="inline");return e||(e=R$1.atRule({name:"theme",params:"inline",nodes:[],raws:{semicolon:true,between:" ",before:`
`}}),t.append(e),t.insertBefore(e,R$1.comment({text:"---break---"}))),e}function Jr({params:t}){return {postcssPlugin:"add-custom-variant",Once(e){if(!e.nodes.find(i=>i.type==="atrule"&&i.name==="custom-variant")){let i=e.nodes.filter(n=>n.type==="atrule"&&n.name==="import"),o=R$1.atRule({name:"custom-variant",params:t,raws:{semicolon:true,before:`
`}});if(i.length>0){let n=i[i.length-1];e.insertAfter(n,o);}else e.insertAfter(e.nodes[0],o);e.insertBefore(o,R$1.comment({text:"---break---"}));}}}}function Yr({params:t}){return {postcssPlugin:"add-custom-import",Once(e){let r=e.nodes.filter(n=>n.type==="atrule"&&n.name==="import"),i=e.nodes.find(n=>n.type==="atrule"&&n.name==="custom-variant");if(!r.some(n=>n.params.replace(/["']/g,"")===t)){let n=R$1.atRule({name:"import",params:`"${t}"`,raws:{semicolon:true,before:`
`}});if(r.length>0){let s=r[r.length-1];e.insertAfter(s,n);}else i?(e.insertBefore(i,n),e.insertBefore(i,R$1.comment({text:"---break---"}))):(e.prepend(n),e.insertAfter(n,R$1.comment({text:"---break---"})));}}}}function qr(t){return {postcssPlugin:"update-tailwind-config",Once(e){if(!t?.plugins)return;let i=Qr(e)==="single"?"'":'"',o=e.nodes.filter(s=>s.type==="atrule"&&s.name==="plugin"),n=o[o.length-1]||e.nodes[0];for(let s of t.plugins){let a=s.replace(/^require\(["']|["']\)$/g,"");if(o.some(l=>l.params.replace(/["']/g,"")===a))continue;let c=R$1.atRule({name:"plugin",params:`${i}${a}${i}`,raws:{semicolon:true,before:`
`}});e.insertAfter(n,c),e.insertBefore(c,R$1.comment({text:"---break---"}));}}}}function Kr(t){return {postcssPlugin:"update-tailwind-config-keyframes",Once(e){if(!t?.theme?.extend?.keyframes)return;let r=Ce(e),i=r.nodes?.filter(n=>n.type==="atrule"&&n.name==="keyframes"),o=z$1.record(z$1.string(),z$1.record(z$1.string(),z$1.string()));for(let[n,s]of Object.entries(t.theme.extend.keyframes)){if(typeof n!="string")continue;let a=o.safeParse(s);if(!a.success||i?.find(l=>l.type==="atrule"&&l.name==="keyframes"&&l.params===n))continue;let c=R$1.atRule({name:"keyframes",params:n,nodes:[],raws:{semicolon:true,between:" ",before:`
  `}});for(let[l,f]of Object.entries(a.data)){let d=R$1.rule({selector:l,nodes:Object.entries(f).map(([u,g])=>R$1.decl({prop:u,value:g,raws:{semicolon:true,before:`
      `,between:": "}})),raws:{semicolon:true,between:" ",before:`
    `}});c.append(d);}r.append(c),r.insertBefore(c,R$1.comment({text:"---break---"}));}}}}function Hr(t){return {postcssPlugin:"update-tailwind-config-animation",Once(e){if(!t?.theme?.extend?.animation)return;let r=Ce(e),i=r.nodes?.filter(n=>n.type==="decl"&&n.prop.startsWith("--animate-")),o=z$1.record(z$1.string(),z$1.string()).safeParse(t.theme.extend.animation);if(o.success)for(let[n,s]of Object.entries(o.data)){let a=`--animate-${n}`;if(i?.find(l=>l.prop===a))continue;let c=R$1.decl({prop:a,value:s,raws:{semicolon:true,between:": ",before:`
  `}});r.append(c);}}}}function Qr(t){return t.nodes[0].toString().includes("'")?"single":"double"}function Ut(t){if(t.startsWith("hsl")||t.startsWith("rgb")||t.startsWith("#")||t.startsWith("oklch"))return  false;let e=t.split(" ");return e.length===3&&e.slice(1,3).every(r=>r.includes("%"))}function Xr(t){return t.startsWith("hsl")||t.startsWith("rgb")||t.startsWith("#")||t.startsWith("oklch")||t.includes("--color-")}async function A(t$1,e,r,i){if(t$1=Array.from(new Set(t$1)),e=Array.from(new Set(e)),!t$1?.length&&!e?.length)return;i={silent:false,...i};let o=t("Installing dependencies.",{silent:i.silent})?.start(),n=await ti(r),s$1="";if(ei(r)&&n==="npm")if(i.silent)s$1="force";else {o.stopAndPersist(),s.warn(`
It looks like you are using React 19. 
Some packages may fail to install due to peer dependency issues in npm (see https://ui.shadcn.com/react-19).
`);let a=await He([{type:"select",name:"flag",message:"How would you like to proceed?",choices:[{title:"Use --force",value:"force"},{title:"Use --legacy-peer-deps",value:"legacy-peer-deps"}]}]);a&&(s$1=a.flag);}o?.start(),await ri(n,t$1,e,r.resolvedPaths.cwd,s$1),o?.succeed();}function ei(t){let e=o(t.resolvedPaths.cwd,false);if(!e?.dependencies?.react)return  false;let r=/^(?:\^|~)?19(?:\.\d+)*(?:-.*)?$/.test(e.dependencies.react),i=e.dependencies["react-day-picker"]?.startsWith("8");return r&&i}async function ti(t){return o(t.resolvedPaths.cwd,false)?.dependencies?.expo?"expo":a$1(t.resolvedPaths.cwd)}async function ri(t,e,r,i,o){if(t==="npm")return ii(e,r,i,o);if(t==="deno")return oi(e,r,i);if(t==="expo")return ni(e,r,i);e?.length&&await execa(t,["add",...e],{cwd:i}),r?.length&&await execa(t,["add","-D",...r],{cwd:i});}async function ii(t,e,r,i){t.length&&await execa("npm",["install",...i?[`--${i}`]:[],...t],{cwd:r}),e.length&&await execa("npm",["install",...i?[`--${i}`]:[],"-D",...e],{cwd:r});}async function oi(t,e,r){t?.length&&await execa("deno",["add",...t.map(i=>`npm:${i}`)],{cwd:r}),e?.length&&await execa("deno",["add","-D",...e.map(i=>`npm:${i}`)],{cwd:r});}async function ni(t,e,r){t.length&&await execa("npx",["expo","install",...t],{cwd:r}),e.length&&await execa("npx",["expo","install","-- -D",...e],{cwd:r});}async function Ye(t$1,e,r){if(!t$1||Object.keys(t$1).length===0)return {envVarsAdded:[],envFileUpdated:null,envFileCreated:null};r={silent:false,...r};let i=t("Adding environment variables.",{silent:r.silent})?.start(),o=e.resolvedPaths.cwd,n=W__default.join(o,".env.local"),s$1=G(o);s$1&&(n=s$1);let a=existsSync(n),c=W__default.basename(n),l=Object.entries(t$1).map(([g,h])=>`${g}=${h}`).join(`
`),f=[],d$1=null,u=null;if(a){let g=await promises.readFile(n,"utf-8"),h=I(g,l);if(f=H(g,l),f.length>0){if(await promises.writeFile(n,h,"utf-8"),d$1=W__default.relative(o,n),i?.succeed(`Added the following variables to ${d.info(c)}:`),!r.silent)for(let y of f)s.log(`  ${d.success("+")} ${y}`);}else i?.stop();}else if(await promises.writeFile(n,l+`
`,"utf-8"),u=W__default.relative(o,n),f=Object.keys(t$1),i?.succeed(`Added the following variables to ${d.info(c)}:`),!r.silent)for(let g of f)s.log(`  ${d.success("+")} ${g}`);return !r.silent&&f.length>0&&s.break(),{envVarsAdded:f,envFileUpdated:d$1,envFileCreated:u}}async function fe(t,e,r){r={overwrite:false,silent:false,isNewProject:false,baseStyle:true,...r};let i=await k(e);return i&&i.ui&&i.ui.resolvedPaths.cwd!==e.resolvedPaths.cwd?await li(t,e,i,{...r,isRemote:t?.length===1&&!!t[0].match(/\/chat\/b\//)}):await ci(t,e,r)}async function ci(t$1,e,r$1){if(!r$1.baseStyle&&!t$1.length)return;let i=t("Checking registry.",{silent:r$1.silent})?.start(),o=await X(t$1,O(e));if(!o)return i?.fail(),Y(new Error("Failed to fetch components from registry."));try{Jt(o.files??[],e.resolvedPaths.cwd);}catch(a){return i?.fail(),Y(a)}i?.succeed();let n=await r(e);await T(o.tailwind?.config,e,{silent:r$1.silent,tailwindVersion:n});let s$1=await Gt(t$1,e);await Ge(o.cssVars,e,{cleanupDefaultNextStyles:r$1.isNewProject,silent:r$1.silent,tailwindVersion:n,tailwindConfig:o.tailwind?.config,overwriteCssVars:s$1,initIndex:r$1.baseStyle}),await Ue(o.css,e,{silent:r$1.silent}),await Ye(o.envVars,e,{silent:r$1.silent}),await A(o.dependencies,o.devDependencies,e,{silent:r$1.silent}),await L$1(o.files,e,{overwrite:r$1.overwrite,silent:r$1.silent,path:r$1.path}),o.docs&&s.info(o.docs);}async function li(t$1,e,r$1,i){if(!i.baseStyle&&!t$1.length)return;let o=t("Checking registry.",{silent:i.silent})?.start(),n=await X(t$1,O(e));if(!n)return o?.fail(),Y(new Error("Failed to fetch components from registry."));try{Jt(n.files??[],e.resolvedPaths.cwd);}catch(y){return o?.fail(),Y(y)}o?.succeed();let s$1=[],a=[],c=[],l$1=t("Installing components.")?.start(),f=r$1.ui,d=await r(f),u=m(e.resolvedPaths.cwd,f.resolvedPaths.ui);if(n.tailwind?.config&&(await T(n.tailwind?.config,f,{silent:true,tailwindVersion:d}),a.push(W__default.relative(u,f.resolvedPaths.tailwindConfig))),n.cssVars){let y=await Gt(t$1,e);await Ge(n.cssVars,f,{silent:true,tailwindVersion:d,tailwindConfig:n.tailwind?.config,overwriteCssVars:y}),a.push(W__default.relative(u,f.resolvedPaths.tailwindCss));}n.css&&(await Ue(n.css,f,{silent:true}),a.push(W__default.relative(u,f.resolvedPaths.tailwindCss))),n.envVars&&await Ye(n.envVars,f,{silent:true}),await A(n.dependencies,n.devDependencies,f,{silent:true});let g=new Map;for(let y of n.files??[]){let C=y.type||"registry:ui";g.has(C)||g.set(C,[]),g.get(C).push(y);}for(let y of Array.from(g.keys())){let C=g.get(y),x=y==="registry:ui"?r$1.ui:e,B=m(e.resolvedPaths.cwd,x.resolvedPaths.ui||x.resolvedPaths.cwd),E=await l(B,x.resolvedPaths.cwd)??x.resolvedPaths.cwd,K=await L$1(C,x,{overwrite:i.overwrite,silent:true,rootSpinner:l$1,isRemote:i.isRemote,isWorkspace:true,path:i.path});s$1.push(...K.filesCreated.map(j=>W__default.relative(B,W__default.join(E,j)))),a.push(...K.filesUpdated.map(j=>W__default.relative(B,W__default.join(E,j)))),c.push(...K.filesSkipped.map(j=>W__default.relative(B,W__default.join(E,j))));}if(l$1?.succeed(),s$1.sort(),a.sort(),c.sort(),!(s$1.length||a.length)&&!c.length&&t("No files updated.",{silent:i.silent})?.info(),s$1.length){t(`Created ${s$1.length} ${s$1.length===1?"file":"files"}:`,{silent:i.silent})?.succeed();for(let y of s$1)s.log(`  - ${y}`);}if(a.length){t(`Updated ${a.length} ${a.length===1?"file":"files"}:`,{silent:i.silent})?.info();for(let y of a)s.log(`  - ${y}`);}if(c.length){t(`Skipped ${c.length} ${a.length===1?"file":"files"}: (use --overwrite to overwrite)`,{silent:i.silent})?.info();for(let y of c)s.log(`  - ${y}`);}n.docs&&s.info(n.docs);}async function Gt(t,e){let r=await _$1(t,{config:e});return z$1.array(g$1).parse(r).some(o=>o.type==="registry:theme"||o.type==="registry:style")}function Jt(t,e){for(let r of t)if(r?.target&&!Lt(r.target,e))throw new Error(`We found an unsafe file path "${r.target} in the registry item. Installation aborted.`)}var pi="https://codeload.github.com/shadcn-ui/ui/tar.gz/main",q={next:"next","next-16":"next-16","next-monorepo":"next-monorepo"};async function ke(t){t={srcDir:false,...t};let e=t.template&&q[t.template]?t.template:"next",r=e===q.next?"my-app":"my-monorepo",i="15",o=t.components?.length===1&&!!t.components[0].match(/\/chat\/b\//);if(t.components&&o)try{let[a]=await S(t.components),{meta:c}=z$1.object({meta:z$1.object({nextVersion:z$1.string()})}).parse(a);i=c.nextVersion,e=q.next;}catch(a){s.break(),Y(a);}if(!t.force){let{type:a,name:c}=await He([{type:t.template||o?null:"select",name:"type",message:`The path ${d.info(t.cwd)} does not contain a package.json file.
  Would you like to start a new project?`,choices:[{title:"Next.js 15",value:"next"},{title:"Next.js 16",value:"next-16"},{title:"Next.js (Monorepo)",value:"next-monorepo"}],initial:0},{type:"text",name:"name",message:"What is your project named?",initial:r,format:l=>l.trim(),validate:l=>l.length>128?"Name should be less than 128 characters.":true}]);e=a??e,r=c,a==="next-16"&&(i="latest");}let n=await a$1(t.cwd,{withFallback:true}),s$1=`${t.cwd}/${r}`;try{await _.access(t.cwd,_.constants.W_OK);}catch{s.break(),s.error(`The path ${d.info(t.cwd)} is not writable.`),s.error(`It is likely you do not have write permissions for this folder or the path ${d.info(t.cwd)} does not exist.`),s.break(),process.exit(1);}return _.existsSync(W__default.resolve(t.cwd,r,"package.json"))&&(s.break(),s.error(`A project with the name ${d.info(r)} already exists.`),s.error("Please choose a different name and try again."),s.break(),process.exit(1)),(e===q.next||e===q["next-16"])&&await di(s$1,{version:i,cwd:t.cwd,packageManager:n,srcDir:!!t.srcDir}),e===q["next-monorepo"]&&await ui(s$1,{packageManager:n}),{projectPath:s$1,projectName:r,template:e}}async function di(t$1,e){let r=t(`Creating a new Next.js ${e.version.startsWith("latest")?"16":"15"} project. This may take a few minutes.`).start(),i=["--tailwind","--eslint","--typescript","--app",e.srcDir?"--src-dir":"--no-src-dir","--no-import-alias",`--use-${e.packageManager}`];(e.version.startsWith("15")||e.version.startsWith("latest")||e.version.startsWith("canary"))&&i.push("--turbopack"),(e.version.startsWith("latest")||e.version.startsWith("canary"))&&i.push("--no-react-compiler");try{await execa("npx",[`create-next-app@${e.version}`,t$1,"--silent",...i],{cwd:e.cwd});}catch{s.break(),s.error("Something went wrong creating a new Next.js project. Please try again."),process.exit(1);}r?.succeed(`Creating a new Next.js ${e.version.startsWith("latest")?"16":"15"} project.`);}async function ui(t$1,e){let r=t("Creating a new Next.js monorepo. This may take a few minutes.").start();try{let i=W__default.join(fi.tmpdir(),`shadcn-template-${Date.now()}`);await _.ensureDir(i);let o=await fetch(pi);if(!o.ok)throw new Error(`Failed to download template: ${o.statusText}`);let n=W__default.resolve(i,"template.tar.gz");await _.writeFile(n,Buffer.from(await o.arrayBuffer())),await execa("tar",["-xzf",n,"-C",i,"--strip-components=2","ui-main/templates/monorepo-next"]);let s=W__default.resolve(i,"monorepo-next");await _.move(s,t$1),await _.remove(i),await execa(e.packageManager,["install"],{cwd:t$1});let a=W__default.join(t$1,"package.json");if(_.existsSync(a)){let l=await _.readFile(a,"utf8"),f=JSON.parse(l);f.name=t$1.split("/").pop(),await _.writeFile(a,JSON.stringify(f,null,2));}let c=process.cwd();await execa("git",["--version"],{cwd:t$1}),await execa("git",["init"],{cwd:t$1}),await execa("git",["add","-A"],{cwd:t$1}),await execa("git",["commit","-m","Initial commit"],{cwd:t$1}),r?.succeed("Creating a new Next.js monorepo.");}catch(i){r?.fail("Something went wrong creating a new Next.js monorepo."),Y(i);}}async function D(t=process.cwd()){try{let{config:e}=await import('@dotenvx/dotenvx'),r=[".env.local",".env.development.local",".env.development",".env"];for(let i of r){let o=join(t,i);existsSync(o)&&e({path:o,overload:!1,quiet:!0});}}catch(e){s.warn("Failed to load env files:",e);}}var pe=".bak";function Yt(t){if(!_.existsSync(t))return null;let e=`${t}${pe}`;try{return _.renameSync(t,e),e}catch(r){return console.error(`Failed to create backup of ${t}: ${r}`),null}}function qt(t){let e=`${t}${pe}`;if(!_.existsSync(e))return  false;try{return _.renameSync(e,t),!0}catch(r){return console.error(`Warning: Could not restore backup file ${e}: ${r}`),false}}function Ke(t){let e=`${t}${pe}`;if(!_.existsSync(e))return  false;try{return _.unlinkSync(e),!0}catch{return  false}}async function Kt(t,e){let r=new Set,i=new Set,o=[...t];for(;o.length>0;){let n=o.shift();if(i.has(n))continue;i.add(n);let{registry:s}=F(n);s&&!b[s]&&r.add(s);try{let[a]=await W$1([n],e,{useCache:!0});if(a?.registryDependencies)for(let c of a.registryDependencies){let{registry:l}=F(c);l&&!b[l]&&r.add(l),i.has(c)||o.push(c);}}catch(a){if(a instanceof z$2){let{registry:c}=F(n);c&&!b[c]&&r.add(c);continue}continue}}return Array.from(r)}async function L(t$1,e,r={}){r={silent:false,writeFile:true,...r};let o=(await Kt(t$1,e)).filter(l=>!e.registries?.[l]&&!Object.keys(b).includes(l));if(o.length===0)return {config:e,newRegistries:[]};let n=await ja({useCache:process.env.NODE_ENV!=="development"});if(!n)return {config:e,newRegistries:[]};let s={};for(let l of o)n[l]&&(s[l]=n[l]);if(Object.keys(s).length===0)return {config:e,newRegistries:[]};let a=Object.fromEntries(Object.entries(e.registries||{}).filter(([l])=>!Object.keys(b).includes(l))),c={...e,registries:{...a,...s}};if(r.writeFile){let{resolvedPaths:l,...f}=c,d=t("Updating components.json.",{silent:r.silent}).start(),u=p.parse(f);await _.writeFile(W__default.resolve(e.resolvedPaths.cwd,"components.json"),JSON.stringify(u,null,2)+`
`,"utf-8"),d.succeed();}return {config:c,newRegistries:Object.keys(s)}}async function Qt(t$1,e,r){if(!t$1)return;r={silent:false,...r};let i=W__default.relative(e.resolvedPaths.cwd,e.resolvedPaths.tailwindConfig),o=t(`Updating ${d.info(i)}`,{silent:r.silent}).start(),n=await promises.readFile(e.resolvedPaths.tailwindConfig,"utf8"),s=await Ri(n,t$1,e);await promises.writeFile(e.resolvedPaths.tailwindConfig,s,"utf8"),o?.succeed();}async function Ri(t,e,r){let i=await U(t,r),o=i.getDescendantsOfKind(SyntaxKind.ObjectLiteralExpression).find(n=>n.getProperties().some(s=>s.isKind(SyntaxKind.PropertyAssignment)&&s.getName()==="content"));return o?(xi(o,e),i.getFullText()):t}async function xi(t,e){let r=V(t),i=t.getProperty("content");if(!i){let o={name:"content",initializer:`[${r}${e.join(`${r}, ${r}`)}${r}]`};return t.addPropertyAssignment(o),t}if(i.isKind(SyntaxKind.PropertyAssignment)){let o=i.getInitializer();if(o?.isKind(SyntaxKind.ArrayLiteralExpression))for(let n of e){let s=`${r}${n}${r}`;o.getElements().map(a=>a.getText()).includes(s)||o.addElement(s);}return t}return t}process.on("exit",t=>{let e=W__default.resolve(process.cwd(),"components.json");return t===0?Ke(e):qt(e)});var Ii=z$1.object({cwd:z$1.string(),components:z$1.array(z$1.string()).optional(),yes:z$1.boolean(),defaults:z$1.boolean(),force:z$1.boolean(),silent:z$1.boolean(),isNewProject:z$1.boolean(),srcDir:z$1.boolean().optional(),cssVariables:z$1.boolean(),template:z$1.string().optional().refine(t=>t?q[t]:true,{message:"Invalid template. Please use 'next', 'next-16' or 'next-monorepo'."}),baseColor:z$1.string().optional().refine(t=>t?a.find(e=>e.name===t):true,{message:`Invalid base color. Please use '${a.map(t=>t.name).join("', '")}'`}),baseStyle:z$1.boolean()}),Xt=new Command().name("init").description("initialize your project and install dependencies").argument("[components...]","names, url or local path to component").option("-t, --template <template>","the template to use. (next, next-16, next-monorepo)").option("-b, --base-color <base-color>","the base color to use. (neutral, gray, zinc, stone, slate)",void 0).option("-y, --yes","skip confirmation prompt.",true).option("-d, --defaults,","use default configuration.",false).option("-f, --force","force overwrite of existing configuration.",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-s, --silent","mute output.",false).option("--src-dir","use the src directory when creating a new project.",false).option("--no-src-dir","do not use the src directory when creating a new project.").option("--css-variables","use css variables for theming.",true).option("--no-css-variables","do not use css variables for theming.").option("--no-base-style","do not install the base shadcn style.").action(async(t,e)=>{try{e.defaults&&(e.template=e.template||"next",e.baseColor=e.baseColor||"neutral");let r=Ii.parse({cwd:W__default.resolve(e.cwd),isNewProject:!1,components:t,...e});if(await D(r.cwd),t.length>0){let i=O(n({resolvedPaths:{cwd:r.cwd}})),o=W__default.resolve(r.cwd,"components.json");if(_.existsSync(o)){let a=await _.readJson(o),c=p.partial().parse(a),l=n({resolvedPaths:{cwd:r.cwd}});i=O({...c,resolvedPaths:{...l.resolvedPaths,cwd:r.cwd}}),Yt(o);}let{config:n$1}=await L(t,i,{silent:!0,writeFile:!1});i=n$1,R(t[0],i);let[s]=await _$1([t[0]],{config:i});s?.type==="registry:style"&&(r.baseColor="neutral",r.baseStyle=s.extends==="none"?!1:r.baseStyle);}r.baseStyle||(r.baseColor="neutral"),await je(r),s.log(`${d.success("Success!")} Project initialization completed.
You may now add components.`),Ke(W__default.resolve(r.cwd,"components.json")),s.break();}catch(r){s.break(),Y(r);}finally{P();}});async function je(t$1){let e,r;if(t$1.skipPreflight)e=await p$1(t$1.cwd);else {let u=await Dt(t$1);if(u.errors["1"]){let{projectPath:g,template:h}=await ke(t$1);g||process.exit(1),t$1.cwd=g,t$1.isNewProject=true,r=h;}e=u.projectInfo;}if(r==="next-monorepo")return t$1.cwd=W__default.resolve(t$1.cwd,"apps/web"),await i(t$1.cwd);let i$1=await q$1(t$1.cwd,e),o=i$1?await Pi(i$1,t$1):await ki(await i(t$1.cwd));if(!t$1.yes){let{proceed:u}=await He({type:"confirm",name:"proceed",message:`Write configuration to ${d.info("components.json")}. Proceed?`,initial:true});u||process.exit(0);}let n=[...t$1.baseStyle?["index"]:[],...t$1.components??[]],s=await j(t$1.cwd,o),{config:a}=await L(n,s,{silent:true});a.registries&&(o.registries=a.registries);let c=t("Writing components.json.").start(),l=W__default.resolve(t$1.cwd,"components.json"),f=`${l}${pe}`;if(!t$1.force&&_.existsSync(f)){let u=await _.readJson(f),{registries:g,...h}=Ci(u,o);o={...h,registries:g};}o.registries=Object.fromEntries(Object.entries(o.registries||{}).filter(([u])=>!Object.keys(b).includes(u))),await promises.writeFile(l,`${JSON.stringify(o,null,2)}
`,"utf8"),c.succeed();let d$1=await j(t$1.cwd,o);return await fe(n,d$1,{overwrite:true,silent:t$1.silent,baseStyle:t$1.baseStyle,isNewProject:t$1.isNewProject||e?.framework.name==="next-app"}),t$1.isNewProject&&t$1.srcDir&&await Qt(["./src/**/*.{js,ts,jsx,tsx,mdx}"],d$1,{silent:t$1.silent}),d$1}async function ki(t=null){let[e$1,r]=await Promise.all([ca(),ea()]);s.info("");let i=await He([{type:"toggle",name:"typescript",message:`Would you like to use ${d.info("TypeScript")} (recommended)?`,initial:t?.tsx??true,active:"yes",inactive:"no"},{type:"select",name:"style",message:`Which ${d.info("style")} would you like to use?`,choices:e$1.map(o=>({title:o.label,value:o.name}))},{type:"select",name:"tailwindBaseColor",message:`Which color would you like to use as the ${d.info("base color")}?`,choices:r.map(o=>({title:o.label,value:o.name}))},{type:"text",name:"tailwindCss",message:`Where is your ${d.info("global CSS")} file?`,initial:t?.tailwind.css??g},{type:"toggle",name:"tailwindCssVariables",message:`Would you like to use ${d.info("CSS variables")} for theming?`,initial:t?.tailwind.cssVariables??true,active:"yes",inactive:"no"},{type:"text",name:"tailwindPrefix",message:`Are you using a custom ${d.info("tailwind prefix eg. tw-")}? (Leave blank if not)`,initial:""},{type:"text",name:"tailwindConfig",message:`Where is your ${d.info("tailwind.config.js")} located?`,initial:t?.tailwind.config??h},{type:"text",name:"components",message:`Configure the import alias for ${d.info("components")}:`,initial:t?.aliases.components??e},{type:"text",name:"utils",message:`Configure the import alias for ${d.info("utils")}:`,initial:t?.aliases.utils??f},{type:"toggle",name:"rsc",message:`Are you using ${d.info("React Server Components")}?`,initial:t?.rsc??true,active:"yes",inactive:"no"}]);return p.parse({$schema:"https://ui.shadcn.com/schema.json",style:i.style,tailwind:{config:i.tailwindConfig,css:i.tailwindCss,baseColor:i.tailwindBaseColor,cssVariables:i.tailwindCssVariables,prefix:i.tailwindPrefix},rsc:i.rsc,tsx:i.typescript,aliases:{utils:i.utils,components:i.components,lib:i.components.replace(/\/components$/,"lib"),hooks:i.components.replace(/\/components$/,"hooks")}})}async function Pi(t,e){let r$1=t.style,i=e.baseColor,o=t.tailwind.cssVariables;if(!e.defaults){let[n,s,a]=await Promise.all([ca(),ea(),r(t)]),c=await He([{type:a==="v4"?null:"select",name:"style",message:`Which ${d.info("style")} would you like to use?`,choices:n.map(l=>({title:l.name==="new-york"?"New York (Recommended)":l.label,value:l.name})),initial:0},{type:e.baseColor?null:"select",name:"tailwindBaseColor",message:`Which color would you like to use as the ${d.info("base color")}?`,choices:s.map(l=>({title:l.label,value:l.name}))}]);r$1=c.style??"new-york",i=c.tailwindBaseColor??i,o=e.cssVariables;}return p.parse({$schema:t?.$schema,style:r$1,tailwind:{...t?.tailwind,baseColor:i,cssVariables:o},rsc:t?.rsc,tsx:t?.tsx,iconLibrary:t?.iconLibrary,aliases:t?.aliases})}async function er(t){let e={};if(!_.existsSync(t.cwd)||!_.existsSync(W__default.resolve(t.cwd,"package.json")))return e["1"]=true,{errors:e,config:null};if(!_.existsSync(W__default.resolve(t.cwd,"components.json")))return e["3"]=true,{errors:e,config:null};try{let r=await i(t.cwd);return {errors:e,config:r}}catch{s.break(),s.error(`An invalid ${d.info("components.json")} file was found at ${d.info(t.cwd)}.
Before you can add components, you must create a valid ${d.info("components.json")} file by running the ${d.info("init")} command.`),s.error(`Learn more at ${d.info("https://ui.shadcn.com/docs/components-json")}.`),s.break(),process.exit(1);}}async function rr(t,e){let r=W__default.join(e.resolvedPaths.cwd,"app/page.tsx");if(!(await z__default.stat(r)).isFile())return;let[i]=await _$1([t],{config:e});if(!i?.meta?.importSpecifier||!i?.meta?.moduleSpecifier)return;let o=`import { ${i?.meta?.importSpecifier} } from "${i.meta.moduleSpecifier}"

export default function Page() {
  return <${i?.meta?.importSpecifier} />
}`;await z__default.writeFile(r,o,"utf8");}var Oi=z$1.object({components:z$1.array(z$1.string()).optional(),yes:z$1.boolean(),overwrite:z$1.boolean(),cwd:z$1.string(),all:z$1.boolean(),path:z$1.string().optional(),silent:z$1.boolean(),srcDir:z$1.boolean().optional(),cssVariables:z$1.boolean()}),or=new Command().name("add").description("add a component to your project").argument("[components...]","names, url or local path to component").option("-y, --yes","skip confirmation prompt.",false).option("-o, --overwrite","overwrite existing files.",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-a, --all","add all available components",false).option("-p, --path <path>","the path to add the component to.").option("-s, --silent","mute output.",false).option("--src-dir","use the src directory when creating a new project.",false).option("--no-src-dir","do not use the src directory when creating a new project.").option("--css-variables","use css variables for theming.",true).option("--no-css-variables","do not use css variables for theming.").action(async(t,e)=>{try{let r=Oi.parse({components:t,cwd:W__default.resolve(e.cwd),...e});await D(r.cwd);let i$1=await i(r.cwd);i$1||(i$1=n({style:"new-york",resolvedPaths:{cwd:r.cwd}}));let o=!1;if(t.length>0){let{config:g,newRegistries:h}=await L(t,i$1,{silent:r.silent,writeFile:!1});i$1=g,o=h.length>0;}let n$1,s$1=!0;if(t.length>0){let[g]=await _$1([t[0]],{config:i$1});if(n$1=g?.type,s$1=n$1!=="registry:theme"&&n$1!=="registry:style",N(g)){await fe(t,i$1,{...r,baseStyle:s$1});return}if(!r.yes&&(n$1==="registry:style"||n$1==="registry:theme")){s.break();let{confirm:h}=await He({type:"confirm",name:"confirm",message:d.warn(`You are about to install a new ${n$1.replace("registry:","")}. 
Existing CSS variables and components will be overwritten. Continue?`)});h||(s.break(),s.log("Installation cancelled."),s.break(),process.exit(1));}}if(r.components?.length||(r.components=await $i(r)),(await p$1(r.cwd))?.tailwindVersion==="v4"){let g=c.filter(h=>r.components?.includes(h.name));g?.length&&(s.break(),g.forEach(h=>{s.warn(d.warn(h.message));}),s.break(),process.exit(1));}let{errors:c$1,config:l}=await er(r),f=!1;if(c$1["3"]){let{proceed:g}=await He({type:"confirm",name:"proceed",message:`You need to create a ${d.info("components.json")} file to add components. Proceed?`,initial:!0});g||(s.break(),process.exit(1)),l=await je({cwd:r.cwd,yes:!0,force:!0,defaults:!1,skipPreflight:!1,silent:r.silent&&!o,isNewProject:!1,srcDir:r.srcDir,cssVariables:r.cssVariables,baseStyle:s$1,baseColor:s$1?void 0:"neutral",components:r.components}),f=!0;}let d$1=!1;if(c$1["1"]){let{projectPath:g,template:h}=await ke({cwd:r.cwd,force:r.overwrite,srcDir:r.srcDir,components:r.components});g||(s.break(),process.exit(1)),r.cwd=g,h==="next-monorepo"?(r.cwd=W__default.resolve(r.cwd,"apps/web"),l=await i(r.cwd)):(l=await je({cwd:r.cwd,yes:!0,force:!0,defaults:!1,skipPreflight:!0,silent:!o&&r.silent,isNewProject:!0,srcDir:r.srcDir,cssVariables:r.cssVariables,baseStyle:s$1,baseColor:s$1?void 0:"neutral",components:r.components}),f=!0,d$1=r.components?.length===1&&!!r.components[0].match(/\/chat\/b\//));}if(!l)throw new Error(`Failed to read config at ${d.info(r.cwd)}.`);let{config:u}=await L(r.components,l,{silent:r.silent||o});l=u,f||await fe(r.components,l,{...r,baseStyle:s$1}),d$1&&await rr(r.components[0],l);}catch(r){s.break(),Y(r);}finally{P();}});async function $i(t){let e=await ba();if(!e)return s.break(),Y(new Error("Failed to fetch registry index.")),[];if(t.all)return e.map(o=>o.name).filter(o=>!c.some(n=>n.name===o));if(t.components?.length)return t.components;let{components:r}=await He({type:"multiselect",name:"components",message:"Which components would you like to add?",hint:"Space to select. A to toggle all. Enter to submit.",instructions:false,choices:e.filter(o=>o.type==="registry:ui"&&!c.some(n=>n.name===o.name)).map(o=>({title:o.name,value:o.name,selected:t.all?true:t.components?.includes(o.name)}))});r?.length||(s.warn("No components selected. Exiting."),s.info(""),process.exit(1));let i=z$1.array(z$1.string()).safeParse(r);return i.success?i.data:(s.error(""),Y(new Error("Something went wrong. Please try again.")),[])}async function ar(t){let e={},r={cwd:t.cwd,registryFile:W__default.resolve(t.cwd,t.registryFile),outputDir:W__default.resolve(t.cwd,t.outputDir)};return _.existsSync(r.registryFile)||(e["13"]=true),await _.mkdir(r.outputDir,{recursive:true}),Object.keys(e).length>0&&(e["13"]&&(s.break(),s.error(`The path ${d.info(r.registryFile)} does not exist.`)),s.break(),process.exit(1)),{errors:e,resolvePaths:r}}var Fi=z$1.object({cwd:z$1.string(),registryFile:z$1.string(),outputDir:z$1.string()}),cr=new Command().name("build").description("build components for a shadcn registry").argument("[registry]","path to registry.json file","./registry.json").option("-o, --output <path>","destination directory for json files","./public/r").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async(t$1,e)=>{try{let r=Fi.parse({cwd:W.resolve(e.cwd),registryFile:t$1,outputDir:e.output}),{resolvePaths:i}=await ar(r),o=await z.readFile(i.registryFile,"utf-8"),n=h$1.safeParse(JSON.parse(o));n.success||(s.error(`Invalid registry file found at ${d.info(i.registryFile)}.`),process.exit(1));let s$1=t("Building registry...");for(let a of n.data.items){s$1.start(`Building ${a.name}...`),a.$schema="https://ui.shadcn.com/schema/registry-item.json";for(let l of a.files??[])l.content=await z.readFile(W.resolve(i.cwd,l.path),"utf-8");let c=g$1.safeParse(a);if(!c.success){s.error(`Invalid registry item found for ${d.info(a.name)}.`);continue}await z.writeFile(W.resolve(i.outputDir,`${c.data.name}.json`),JSON.stringify(c.data,null,2));}await z.copyFile(i.registryFile,W.resolve(i.outputDir,"registry.json")),s$1.succeed("Building registry.");}catch(r){s.break(),Y(r);}});var Di=z$1.object({component:z$1.string().optional(),yes:z$1.boolean(),cwd:z$1.string(),path:z$1.string().optional()}),fr=new Command().name("diff").description("check for updates against the registry").argument("[component]","the component name").option("-y, --yes","skip confirmation prompt.",false).option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async(t,e)=>{try{let r=Di.parse({component:t,...e}),i$1=W__default.resolve(r.cwd);existsSync(i$1)||(s.error(`The path ${i$1} does not exist. Please try again.`),process.exit(1));let o=await i(i$1);o||(s.warn(`Configuration is missing. Please run ${d.success("init")} to create a components.json file.`),process.exit(1));let n=await ba();if(n||(Y(new Error("Failed to fetch registry index.")),process.exit(1)),!r.component){let c=o.resolvedPaths.components,l=n.filter(d=>{for(let u of d.files??[]){let g=W__default.resolve(c,typeof u=="string"?u:u.path);if(existsSync(g))return !0}return !1}),f=[];for(let d of l){let u=await lr(d,o);u.length&&f.push({name:d.name,changes:u});}f.length||(s.info("No updates found."),process.exit(0)),s.info("The following components have updates available:");for(let d of f){s.info(`- ${d.name}`);for(let u of d.changes)s.info(`  - ${u.filePath}`);}s.break(),s.info(`Run ${d.success("diff <component>")} to see the changes.`),process.exit(0);}let s$1=n.find(c=>c.name===r.component);s$1||(s.error(`The component ${d.success(r.component)} does not exist.`),process.exit(1));let a=await lr(s$1,o);a.length||(s.info(`No updates found for ${r.component}.`),process.exit(0));for(let c of a)s.info(`- ${c.filePath}`),await Li(c.patch),s.info("");}catch(r){Y(r);}});async function lr(t,e){let r=await ha(e.style,[t]),i=await fa(e.tailwind.baseColor);if(!r)return [];let o=[];for(let n of r){let s=await ia(e,n);if(s)for(let a of n.files??[]){let c=W__default.resolve(s,typeof a=="string"?a:a.path);if(!existsSync(c))continue;let l=await promises.readFile(c,"utf8");if(typeof a=="string"||!a.content)continue;let f=await K({filename:a.path,raw:a.content,config:e,baseColor:i}),d=diffLines(f,l);d.length>1&&o.push({filePath:c,patch:d});}}return o}async function Li(t){t.forEach(e=>{if(e)return e.added?process.stdout.write(d.success(e.value)):e.removed?process.stdout.write(d.error(e.value)):process.stdout.write(e.value)});}var mr=new Command().name("info").description("get information about your project").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async t=>{try{s.info("> project info"),console.log(await p$1(t.cwd)),s.break(),s.info("> components.json"),console.log(await i(t.cwd));}catch(e){Y(e);}});var ae="latest",Ne=[{name:"claude",label:"Claude Code",configPath:".mcp.json",config:{mcpServers:{shadcn:{command:"npx",args:[`shadcn@${ae}`,"mcp"]}}}},{name:"cursor",label:"Cursor",configPath:".cursor/mcp.json",config:{mcpServers:{shadcn:{command:"npx",args:[`shadcn@${ae}`,"mcp"]}}}},{name:"vscode",label:"VS Code",configPath:".vscode/mcp.json",config:{servers:{shadcn:{command:"npx",args:[`shadcn@${ae}`,"mcp"]}}}},{name:"codex",label:"Codex",configPath:".codex/config.toml",config:`[mcp_servers.shadcn]
command = "npx"
args = ["shadcn@${ae}", "mcp"]
`}],$e=[`shadcn@${ae}`],rt=new Command().name("mcp").description("MCP server and configuration commands").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async t=>{try{await D(t.cwd);let e=new StdioServerTransport;await b$1.connect(e);}catch(e){s.break(),Y(e);}}),Gi=tt.object({client:tt.enum(["claude","cursor","vscode","codex"]),cwd:tt.string()});rt.command("init").description("Initialize MCP configuration for your client").option("--client <client>",`MCP client (${Ne.map(t=>t.name).join(", ")})`).action(async(t$1,e)=>{try{let i$1=(e.parent?.opts()||{}).cwd||process.cwd(),o=t$1.client;if(!o){let l=await He({type:"select",name:"client",message:"Which MCP client are you using?",choices:Ne.map(f=>({title:f.label,value:f.name}))});l.client||(s.break(),process.exit(1)),o=l.client;}let n=Gi.parse({client:o,cwd:i$1}),s$1=await i(n.cwd);if(n.client==="codex"){if(s$1)await A([],$e,s$1,{silent:!1});else {let l=await a$1(n.cwd),f=l==="npm"?"install":"add",d=l==="npm"?"--save-dev":"-D",u=t("Installing dependencies...").start();await execa(l,[f,d,...$e],{cwd:n.cwd}),u.succeed("Installing dependencies.");}s.break(),s.log("To configure the shadcn MCP server in Codex:"),s.break(),s.log(`1. Open or create the file ${d.info("~/.codex/config.toml")}`),s.log("2. Add the following configuration:"),s.log(),s.info(`[mcp_servers.shadcn]
command = "npx"
args = ["shadcn@${ae}", "mcp"]`),s.break(),s.info("3. Restart Codex to load the MCP server"),s.break(),process.exit(0);}let a=t("Configuring MCP server...").start(),c=await Yi(n);if(a.succeed("Configuring MCP server."),s$1)await A([],$e,s$1,{silent:!1});else {let l=await a$1(n.cwd),f=l==="npm"?"install":"add",d=l==="npm"?"--save-dev":"-D",u=t("Installing dependencies...").start();await execa(l,[f,d,...$e],{cwd:n.cwd}),u.succeed("Installing dependencies.");}s.break(),s.success(`Configuration saved to ${c}.`),s.break();}catch(r){Y(r);}});var Ji=(t,e)=>e;async function Yi(t){let{client:e,cwd:r}=t,i=Ne.find(c=>c.name===e);if(!i)throw new Error(`Unknown client: ${e}. Available clients: ${Ne.map(c=>c.name).join(", ")}`);let o=W__default.join(r,i.configPath),n=W__default.dirname(o);await _.ensureDir(n);let s={};try{let c=await promises.readFile(o,"utf-8");s=JSON.parse(c);}catch{}let a=Ci(s,i.config,{arrayMerge:Ji});return await promises.writeFile(o,JSON.stringify(a,null,2)+`
`,"utf-8"),i.configPath}async function hr(t$1){if(!t$1.resolvedPaths.ui)throw new Error("We could not find a valid `ui` path in your `components.json` file. Please ensure you have a valid `ui` path in your `components.json` file.");let e=t$1.resolvedPaths.ui,[r,i]=await Promise.all([Hi("**/*.{js,ts,jsx,tsx}",{cwd:e}),da()]);if(Object.keys(i).length===0)throw new Error("Something went wrong fetching the registry icons.");let o=Object.entries(J).map(([f,d])=>({title:d.name,value:f})),n=await He([{type:"select",name:"sourceLibrary",message:`Which icon library would you like to ${d.info("migrate from")}?`,choices:o},{type:"select",name:"targetLibrary",message:`Which icon library would you like to ${d.info("migrate to")}?`,choices:o}]);if(n.sourceLibrary===n.targetLibrary)throw new Error("You cannot migrate to the same icon library. Please choose a different icon library.");if(!(n.sourceLibrary in J&&n.targetLibrary in J))throw new Error("Invalid icon library. Please choose a valid icon library.");let s$1=J[n.sourceLibrary],a=J[n.targetLibrary],{confirm:c}=await He({type:"confirm",name:"confirm",initial:true,message:`We will migrate ${d.info(r.length)} files in ${d.info(`./${W__default.relative(t$1.resolvedPaths.cwd,e)}`)} from ${d.info(s$1.name)} to ${d.info(a.name)}. Continue?`});c||(s.info("Migration cancelled."),process.exit(0)),a.package&&await A([a.package],[],t$1,{silent:false});let l=t("Migrating icons...")?.start();await Promise.all(r.map(async f=>{l.text=`Migrating ${f}...`;let d=W__default.join(e,f),u=await promises.readFile(d,"utf-8"),g=await eo(u,n.sourceLibrary,n.targetLibrary,i);await promises.writeFile(d,g);})),l.succeed("Migration complete.");}async function eo(t,e,r,i){let o=J[e]?.import,n=J[r]?.import,s=await promises.mkdtemp(W__default.join(tmpdir(),"shadcn-")),a=new Project({compilerOptions:{}}),c=W__default.join(s,`shadcn-icons-${randomBytes(4).toString("hex")}.tsx`),l=a.createSourceFile(c,t,{scriptKind:ScriptKind.TSX}),f=[];for(let d of l.getImportDeclarations()??[])if(d.getModuleSpecifier()?.getText()===`"${o}"`){for(let u of d.getNamedImports()??[]){let g=u.getName(),h=Object.values(i).find(y=>y[e]===g)?.[r];!h||f.includes(h)||(f.push(h),u.remove(),l.getDescendantsOfKind(SyntaxKind.JsxSelfClosingElement).filter(y=>y.getTagNameNode()?.getText()===g).forEach(y=>y.getTagNameNode()?.replaceWithText(h)));}d.getNamedImports()?.length===0&&d.remove();}return f.length>0&&l.addImportDeclaration({moduleSpecifier:n,namedImports:f.map(d=>({name:d}))}),await l.getText()}function io(t){return t.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("")}function oo(t,e,r,i){let n=t.replace(/\/\/.*$/gm,"").replace(/\/\*[\s\S]*?\*\//g,"").replace(/\s+/g," ").trim().split(",").map(s=>s.trim()).filter(Boolean);for(let s of n){let a=s.match(/^type\s+(\w+)(?:\s+as\s+(\w+))?$/),c=s.match(/^(\w+)\s+as\s+(\w+)$/);if(a){let l=a[1],f=a[2];i==="slot"&&l==="Slot"&&!f?r.push({name:"Slot",alias:"SlotPrimitive",isType:true}):r.push({name:l,alias:f,isType:true});}else if(c){let l=c[1],f=c[2];i==="slot"&&l==="Slot"&&f==="Slot"?r.push({name:"Slot",alias:"SlotPrimitive",isType:e}):r.push({name:l,alias:f,isType:e});}else i==="slot"&&s==="Slot"?r.push({name:"Slot",alias:"SlotPrimitive",isType:e}):r.push({name:s,isType:e});}}async function wr(t$1,e={}){if(!t$1.resolvedPaths.ui)throw new Error("We could not find a valid `ui` path in your `components.json` file. Please ensure you have a valid `ui` path in your `components.json` file.");let r=t$1.resolvedPaths.ui,i=await Hi("**/*.{js,ts,jsx,tsx}",{cwd:r});if(!e.yes){let{confirm:a}=await He({type:"confirm",name:"confirm",initial:true,message:`We will migrate ${d.info(i.length)} files in ${d.info(`./${W__default.relative(t$1.resolvedPaths.cwd,r)}`)} to ${d.info("radix-ui")}. Continue?`});a||(s.info("Migration cancelled."),process.exit(0));}let o$1=t("Migrating imports...")?.start(),n=new Set;await Promise.all(i.map(async a=>{o$1.text=`Migrating ${a}...`;let c=W__default.join(r,a),l=await promises.readFile(c,"utf-8"),{content:f,replacedPackages:d}=await no(l);d.forEach(u=>n.add(u)),await promises.writeFile(c,f);})),o$1.succeed("Migrating imports.");let s$1=t("Updating package.json...")?.start();try{let a=o(t$1.resolvedPaths.cwd,!1);if(!a){s$1.fail("Could not read package.json"),s.warn("Could not update package.json. You may need to manually replace @radix-ui/react-* packages with radix-ui");return}let c=Array.from(n),l=["dependencies","devDependencies"];for(let f of l)if(a[f])for(let d of c)a[f][d]&&delete a[f][d];if(c.length>0){a.dependencies||(a.dependencies={}),a.dependencies["radix-ui"]="latest";let f=W__default.join(t$1.resolvedPaths.cwd,"package.json");await promises.writeFile(f,JSON.stringify(a,null,2)+`
`),s$1.succeed("Updated package.json."),await A(["radix-ui"],[],t$1,{silent:!1});}else s$1.succeed("No packages found in source files.");}catch{s$1.fail("Failed to update package.json"),s.warn("You may need to manually replace @radix-ui/react-* packages with radix-ui");}}async function no(t){let e=/import\s+(?:(type)\s+)?(?:\*\s+as\s+(\w+)|{([^}]+)})\s+from\s+(["'])@radix-ui\/react-([^"']+)\4(;?)/g,r=[],i=[],o=[],n='"',s=false,a=t,c;for(;(c=e.exec(t))!==null;){let[h,y,C,x,B,E,K]=c;if(E==="icons"||E.startsWith("icons/"))continue;i.push(h),i.length===1&&(n=B,s=K===";"),o.push(`@radix-ui/react-${E}`);let j=!!y;if(C){let Te=io(E);r.push({name:Te,alias:C,isType:j});}else x&&oo(x,j,r,E);}if(r.length===0)return {content:t,replacedPackages:[]};let l=r.filter((h,y,C)=>y===C.findIndex(x=>x.name===h.name&&x.alias===h.alias&&x.isType===h.isType)),d=`import { ${l.map(h=>{let y=h.isType?"type ":"";return h.alias?`${y}${h.name} as ${h.alias}`:`${y}${h.name}`}).join(", ")} } from ${n}radix-ui${n}${s?";":""}`;a=i.reduce((h,y,C)=>h.replace(y,C===0?d:""),a),a=a.replace(/\n\s*\n\s*\n/g,`

`),l.some(h=>h.name==="Slot"&&h.alias==="SlotPrimitive")&&(a=a.split(`
`).map(C=>{if(C.trim().startsWith("import "))return C;let x=C;return x=x.replace(/\b(asChild\s*\?\s*)Slot(\s*:)/g,"$1__SLOT_PLACEHOLDER__$2"),x=x.replace(/\bReact\.ComponentProps<typeof\s+Slot>/g,"React.ComponentProps<typeof __SLOT_PLACEHOLDER__>"),x=x.replace(/\bComponentProps<typeof\s+Slot>/g,"ComponentProps<typeof __SLOT_PLACEHOLDER__>"),x=x.replace(/(<\/?)Slot(\s*\/?>)/g,"$1__SLOT_PLACEHOLDER__$2"),x=x.replace(/\bSlot\b/g,(B,E,K)=>{let j=K.substring(0,E),Te=(j.match(/"/g)||[]).length,Fr=(j.match(/'/g)||[]).length;return Te%2!==0||Fr%2!==0?B:"__SLOT_PLACEHOLDER__"}),x=x.replace(/__SLOT_PLACEHOLDER__/g,"SlotPrimitive.Slot"),x}).join(`
`));let g=Array.from(new Set(o));return {content:a,replacedPackages:g}}async function br(t){let e={};if(!_.existsSync(t.cwd)||!_.existsSync(W__default.resolve(t.cwd,"package.json")))return e["1"]=true,{errors:e,config:null};if(!_.existsSync(W__default.resolve(t.cwd,"components.json")))return e["3"]=true,{errors:e,config:null};try{let r=await i(t.cwd);return {errors:e,config:r}}catch{s.break(),s.error(`An invalid ${d.info("components.json")} file was found at ${d.info(t.cwd)}.
Before you can run a migration, you must create a valid ${d.info("components.json")} file by running the ${d.info("init")} command.`),s.error(`Learn more at ${d.info("https://ui.shadcn.com/docs/components-json")}.`),s.break(),process.exit(1);}}var Rr=[{name:"icons",description:"migrate your ui components to a different icon library."},{name:"radix",description:"migrate to radix-ui."}],co=z$1.object({cwd:z$1.string(),list:z$1.boolean(),yes:z$1.boolean(),migration:z$1.string().refine(t=>t&&Rr.some(e=>e.name===t),{message:"You must specify a valid migration. Run `shadcn migrate --list` to see available migrations."}).optional()}),xr=new Command().name("migrate").description("run a migration.").argument("[migration]","the migration to run.").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-l, --list","list all migrations.",false).option("-y, --yes","skip confirmation prompt.",false).action(async(t,e)=>{try{let r=co.parse({cwd:W__default.resolve(e.cwd),migration:t,list:e.list,yes:e.yes});if(r.list||!r.migration){s.info("Available migrations:");for(let n of Rr)s.info(`- ${n.name}: ${n.description}`);return}if(!r.migration)throw new Error("You must specify a migration. Run `shadcn migrate --list` to see available migrations.");let{errors:i,config:o}=await br(r);if(i["1"]||i["3"])throw new Error("No `components.json` file found. Ensure you are at the root of your project.");if(!o)throw new Error("Something went wrong reading your `components.json` file. Please ensure you have a valid `components.json` file.");r.migration==="icons"&&await hr(o),r.migration==="radix"&&await wr(o,{yes:r.yes});}catch(r){s.break(),Y(r);}});async function vr(t){let e={},r={cwd:t.cwd,registryFile:W__default.resolve(t.cwd,t.registryFile),outputDir:W__default.resolve(t.cwd,t.outputDir)};if(!_.existsSync(r.registryFile))return e["13"]=true,{errors:e,resolvePaths:null,config:null};if(!_.existsSync(W__default.resolve(t.cwd,"components.json")))return e["3"]=true,{errors:e,resolvePaths:null,config:null};await _.mkdir(r.outputDir,{recursive:true});try{let i$1=await i(t.cwd);return {errors:e,config:i$1,resolvePaths:r}}catch{s.break(),s.error(`An invalid ${d.info("components.json")} file was found at ${d.info(t.cwd)}.
Before you can build the registry, you must create a valid ${d.info("components.json")} file by running the ${d.info("init")} command.`),s.break(),process.exit(1);}}var fo=z$1.object({cwd:z$1.string(),registryFile:z$1.string(),outputDir:z$1.string(),verbose:z$1.boolean().optional().default(false)}),Sr=new Command().name("registry:build").description("builds the registry [EXPERIMENTAL]").argument("[registry]","path to registry.json file","./registry.json").option("-o, --output <path>","destination directory for json files","./public/r").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-v, --verbose","verbose output").action(async(t,e)=>{await mo({cwd:W.resolve(e.cwd),registryFile:t,outputDir:e.output,verbose:e.verbose});});async function mo(t$1){try{let e=fo.parse(t$1),[{errors:r,resolvePaths:i,config:o},n]=await Promise.all([vr(e),p$1(e.cwd)]);(r["3"]||!o||!n)&&(s.error(`A ${d.info("components.json")} file is required to build the registry. Run ${d.info("shadcn init")} to create one.`),s.break(),process.exit(1)),(r["13"]||!i)&&(s.error(`We could not find a registry file at ${d.info(W.resolve(e.cwd,e.registryFile))}.`),s.break(),process.exit(1));let s$1=await z.readFile(i.registryFile,"utf-8"),a=h$1.safeParse(JSON.parse(s$1));a.success||(s.error(`Invalid registry file found at ${d.info(i.registryFile)}.`),s.break(),process.exit(1));let c=t("Building registry..."),l=await po(a.data,o,n);for(let f of l.items)f.files=f.files?.filter((d,u,g)=>u===g.findIndex(h=>h.path===d.path)),f.dependencies&&(f.dependencies=f.dependencies.filter((d,u,g)=>u===g.findIndex(h=>h===d)));for(let f of l.items){if(!f.files)continue;c.start(`Building ${f.name}...`),f.$schema="https://ui.shadcn.com/schema/registry-item.json";for(let u of f.files){let g=W.resolve(i.cwd,u.path);try{if(!(await z.stat(g)).isFile())continue;u.content=await z.readFile(g,"utf-8");}catch(h){console.error("Error reading file in registry build:",g,h);continue}}let d$1=g$1.safeParse(f);if(!d$1.success){s.error(`Invalid registry item found for ${d.info(f.name)}.`);continue}await z.writeFile(W.resolve(i.outputDir,`${d$1.data.name}.json`),JSON.stringify(d$1.data,null,2));}if(await z.copyFile(i.registryFile,W.resolve(i.outputDir,"registry.json")),c.succeed("Building registry."),e.verbose){t(`The registry has ${d.info(l.items.length.toString())} items:`).succeed();for(let f of l.items){s.log(`  - ${f.name} (${d.info(f.type)})`);for(let d of f.files??[])s.log(`    - ${d.path}`);}}}catch(e){s.break(),Y(e);}}async function po(t,e,r){for(let i of t.items)if(i.files?.length)for(let o of i.files){let n=await M(o.path,e,r);n.files=n.files?.filter(s=>s.path!==o.path),n.files&&i.files.push(...n.files),n.dependencies&&(i.dependencies=i.dependencies?i.dependencies.concat(n.dependencies):n.dependencies);}return t}var Cr=new Command().name("registry:mcp").description("starts the registry MCP server [DEPRECATED]").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async()=>{s.warn(`The ${d.info("shadcn registry:mcp")} command is deprecated. Use the ${d.info("shadcn mcp")} command instead.`),s.break();});var ho=z$1.object({cwd:z$1.string(),query:z$1.string().optional(),limit:z$1.number().optional(),offset:z$1.number().optional()}),Pr=new Command().name("search").alias("list").description("search items from registries").argument("<registries...>","the registry names or urls to search items from. Names must be prefixed with @.").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).option("-q, --query <query>","query string").option("-l, --limit <number>","maximum number of items to display per registry","100").option("-o, --offset <number>","number of items to skip","0").action(async(t,e)=>{try{let r=ho.parse({cwd:W__default.resolve(e.cwd),query:e.query,limit:e.limit?parseInt(e.limit,10):void 0,offset:e.offset?parseInt(e.offset,10):void 0});await D(r.cwd);let i$1=n({style:"new-york",resolvedPaths:{cwd:r.cwd}}),o=O(i$1),n$1=W__default.resolve(r.cwd,"components.json");if(_.existsSync(n$1)){let f=await _.readJson(n$1),d=p.partial().parse(f);o=O({...i$1,...d});}let s=o;try{let f=await i(r.cwd);f&&(s=O(f));}catch{}let{config:a,newRegistries:c}=await L(t.map(f=>`${f}/registry`),s,{silent:!0,writeFile:!1});c.length>0&&(s.registries=a.registries),Q(t,s);let l=await ka(t,{query:r.query,limit:r.limit,offset:r.offset,config:s});console.log(JSON.stringify(l,null,2)),process.exit(0);}catch(r){Y(r);}finally{P();}});var yo=z$1.object({cwd:z$1.string()}),$r=new Command().name("view").description("view items from the registry").argument("<items...>","the item names or URLs to view").option("-c, --cwd <cwd>","the working directory. defaults to the current directory.",process.cwd()).action(async(t,e)=>{try{let r=yo.parse({cwd:W__default.resolve(e.cwd)});await D(r.cwd);let i$1=O({}),o=W__default.resolve(r.cwd,"components.json");if(_.existsSync(o)){let l=await _.readJson(o),f=p.partial().parse(l);i$1=O(f);}let n=i$1;try{let l=await i(r.cwd);l&&(n=O(l));}catch{}let{config:s,newRegistries:a}=await L(t,n,{silent:!0,writeFile:!1});a.length>0&&(n.registries=s.registries),Q(t,n);let c=await _$1(t,{config:n});console.log(JSON.stringify(c,null,2)),process.exit(0);}catch(r){Y(r);}finally{P();}});var Nr={version:"3.5.2"};process.on("SIGINT",()=>process.exit(0));process.on("SIGTERM",()=>process.exit(0));async function xo(){let t=new Command().name("shadcn").description("add items from registries to your project").version(Nr.version,"-v, --version","display the version number");t.addCommand(Xt).addCommand(or).addCommand(fr).addCommand($r).addCommand(Pr).addCommand(xr).addCommand(mr).addCommand(cr).addCommand(rt),t.addCommand(Sr).addCommand(Cr),t.parse();}xo();//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map